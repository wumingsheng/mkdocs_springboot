{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to MkDocs \u00b6 For full documentation visit mkdocs.org . Commands \u00b6 mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message. Project layout \u00b6 1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Home"},{"location":"#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message.","title":"Commands"},{"location":"#project-layout","text":"1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"guava/","text":"guava-retry\u91cd\u8bd5\u673a\u5236 \u00b6 1 2 3 4 5 <dependency> <groupId> com.github.rholder </groupId> <artifactId> guava-retrying </artifactId> <version> 2.0.0 </version> </dependency> 1 2 3 4 5 6 7 8 9 10 Retryer < Boolean > retryer = RetryerBuilder .< Boolean > newBuilder () . retryIfResult ( Predicates . equalTo ( false )) . retryIfRuntimeException () . retryIfException () . withStopStrategy ( StopStrategies . neverStop ()) . build (); retryer . call (()->{ scene . setSceneKey ( IDUtil . verifyCode ()); return sceneService . save ( scene ); }); \u5b57\u7b26\u4e32\u5207\u5272Splitter \u00b6 1 2 3 4 5 List < String > bigbayAppIdList = Splitter . on ( \",\" ) . omitEmptyStrings () . trimResults () . splitToList ( \"123,fjdi, 88,99 , , 8 9 \" ) . forEach ( System . out :: println ); \u8fd0\u884c\u7ed3\u679c 123 fjdi 88 99 8 9 \u62c6\u5206\u5668\u5de5\u5382 \u65b9\u6cd5 \u63cf\u8ff0 \u8303\u4f8b Splitter.on(char) \u6309\u5355\u4e2a\u5b57\u7b26\u62c6\u5206 Splitter.on(\u2018;\u2019) Splitter.on(CharMatcher) \u6309\u5b57\u7b26\u5339\u914d\u5668\u62c6\u5206 Splitter.on(CharMatcher.BREAKING_WHITESPACE) Splitter.on(String) \u6309\u5b57\u7b26\u4e32\u62c6\u5206 Splitter.on(\u201c, \u201c) Splitter.on(Pattern) Splitter.onPattern(String) \u6309\u6b63\u5219\u8868\u8fbe\u5f0f\u62c6\u5206 Splitter.onPattern(\u201c\\r?\\n\u201d) Splitter.fixedLength(int) \u6309\u56fa\u5b9a\u957f\u5ea6\u62c6\u5206\uff1b\u6700\u540e\u4e00\u6bb5\u53ef\u80fd\u6bd4\u7ed9\u5b9a\u957f\u5ea6\u77ed\uff0c\u4f46\u4e0d\u4f1a\u4e3a\u7a7a\u3002 Splitter.fixedLength(3) \u62c6\u5206\u5668\u4fee\u9970\u7b26 \u65b9\u6cd5 \u63cf\u8ff0 omitEmptyStrings() \u4ece\u7ed3\u679c\u4e2d\u81ea\u52a8\u5ffd\u7565\u7a7a\u5b57\u7b26\u4e32 trimResults() \u79fb\u9664\u7ed3\u679c\u5b57\u7b26\u4e32\u7684\u524d\u5bfc\u7a7a\u767d\u548c\u5c3e\u90e8\u7a7a\u767d trimResults(CharMatcher) \u7ed9\u5b9a\u5339\u914d\u5668\uff0c\u79fb\u9664\u7ed3\u679c\u5b57\u7b26\u4e32\u7684\u524d\u5bfc\u5339\u914d\u5b57\u7b26\u548c\u5c3e\u90e8\u5339\u914d\u5b57\u7b26 limit(int) \u9650\u5236\u62c6\u5206\u51fa\u7684\u5b57\u7b26\u4e32\u6570\u91cf","title":"guava"},{"location":"guava/#guava-retry","text":"1 2 3 4 5 <dependency> <groupId> com.github.rholder </groupId> <artifactId> guava-retrying </artifactId> <version> 2.0.0 </version> </dependency> 1 2 3 4 5 6 7 8 9 10 Retryer < Boolean > retryer = RetryerBuilder .< Boolean > newBuilder () . retryIfResult ( Predicates . equalTo ( false )) . retryIfRuntimeException () . retryIfException () . withStopStrategy ( StopStrategies . neverStop ()) . build (); retryer . call (()->{ scene . setSceneKey ( IDUtil . verifyCode ()); return sceneService . save ( scene ); });","title":"guava-retry\u91cd\u8bd5\u673a\u5236"},{"location":"guava/#splitter","text":"1 2 3 4 5 List < String > bigbayAppIdList = Splitter . on ( \",\" ) . omitEmptyStrings () . trimResults () . splitToList ( \"123,fjdi, 88,99 , , 8 9 \" ) . forEach ( System . out :: println ); \u8fd0\u884c\u7ed3\u679c 123 fjdi 88 99 8 9 \u62c6\u5206\u5668\u5de5\u5382 \u65b9\u6cd5 \u63cf\u8ff0 \u8303\u4f8b Splitter.on(char) \u6309\u5355\u4e2a\u5b57\u7b26\u62c6\u5206 Splitter.on(\u2018;\u2019) Splitter.on(CharMatcher) \u6309\u5b57\u7b26\u5339\u914d\u5668\u62c6\u5206 Splitter.on(CharMatcher.BREAKING_WHITESPACE) Splitter.on(String) \u6309\u5b57\u7b26\u4e32\u62c6\u5206 Splitter.on(\u201c, \u201c) Splitter.on(Pattern) Splitter.onPattern(String) \u6309\u6b63\u5219\u8868\u8fbe\u5f0f\u62c6\u5206 Splitter.onPattern(\u201c\\r?\\n\u201d) Splitter.fixedLength(int) \u6309\u56fa\u5b9a\u957f\u5ea6\u62c6\u5206\uff1b\u6700\u540e\u4e00\u6bb5\u53ef\u80fd\u6bd4\u7ed9\u5b9a\u957f\u5ea6\u77ed\uff0c\u4f46\u4e0d\u4f1a\u4e3a\u7a7a\u3002 Splitter.fixedLength(3) \u62c6\u5206\u5668\u4fee\u9970\u7b26 \u65b9\u6cd5 \u63cf\u8ff0 omitEmptyStrings() \u4ece\u7ed3\u679c\u4e2d\u81ea\u52a8\u5ffd\u7565\u7a7a\u5b57\u7b26\u4e32 trimResults() \u79fb\u9664\u7ed3\u679c\u5b57\u7b26\u4e32\u7684\u524d\u5bfc\u7a7a\u767d\u548c\u5c3e\u90e8\u7a7a\u767d trimResults(CharMatcher) \u7ed9\u5b9a\u5339\u914d\u5668\uff0c\u79fb\u9664\u7ed3\u679c\u5b57\u7b26\u4e32\u7684\u524d\u5bfc\u5339\u914d\u5b57\u7b26\u548c\u5c3e\u90e8\u5339\u914d\u5b57\u7b26 limit(int) \u9650\u5236\u62c6\u5206\u51fa\u7684\u5b57\u7b26\u4e32\u6570\u91cf","title":"\u5b57\u7b26\u4e32\u5207\u5272Splitter"},{"location":"okhttp/","text":"springboot \u6574\u5408 okhttp3 \u00b6 Tip okhttp3 + kotlin = okhttp4 1. \u6dfb\u52a0pom\u4f9d\u8d56 \u00b6 1 2 3 4 5 6 7 8 9 <dependency> <groupId> com.squareup.okhttp3 </groupId> <artifactId> okhttp </artifactId> <version> 3.14.2 </version> </dependency> <dependency> <groupId> org.apache.commons </groupId> <artifactId> commons-lang3 </artifactId> </dependency> 2. \u914d\u7f6e\u7c7b \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 package com.example.demo.config ; import java.security.KeyManagementException ; import java.security.NoSuchAlgorithmException ; import java.security.SecureRandom ; import java.security.cert.CertificateException ; import java.security.cert.X509Certificate ; import java.util.concurrent.TimeUnit ; import javax.net.ssl.SSLContext ; import javax.net.ssl.SSLSocketFactory ; import javax.net.ssl.TrustManager ; import javax.net.ssl.X509TrustManager ; import okhttp3.ConnectionPool ; import okhttp3.OkHttpClient ; import org.springframework.context.annotation.Bean ; import org.springframework.context.annotation.Configuration ; @Configuration public class OkHttpConfig { @Bean public X509TrustManager x509TrustManager () { return new X509TrustManager () { @Override public void checkClientTrusted ( X509Certificate [] arg0 , String arg1 ) throws CertificateException { // TODO Auto-generated method stub } @Override public void checkServerTrusted ( X509Certificate [] arg0 , String arg1 ) throws CertificateException { // TODO Auto-generated method stub } @Override public X509Certificate [] getAcceptedIssuers () { return new X509Certificate [ 0 ]; } }; } @Bean public SSLSocketFactory sslSocketFactory () { try { //\u4fe1\u4efb\u4efb\u4f55\u94fe\u63a5 SSLContext sslContext = SSLContext . getInstance ( \"TLS\" ); sslContext . init ( null , new TrustManager []{ x509TrustManager ()}, new SecureRandom ()); return sslContext . getSocketFactory (); } catch ( NoSuchAlgorithmException e ) { e . printStackTrace (); } catch ( KeyManagementException e ) { e . printStackTrace (); } return null ; } /** * Create a new connection pool with tuning parameters appropriate for a single-user application. * The tuning parameters in this pool are subject to change in future OkHttp releases. Currently */ @Bean public ConnectionPool pool () { return new ConnectionPool ( 200 , 5 , TimeUnit . MINUTES ); } @Bean public OkHttpClient okHttpClient () { return new OkHttpClient . Builder () . sslSocketFactory ( sslSocketFactory (), x509TrustManager ()) . retryOnConnectionFailure ( false ) //\u662f\u5426\u5f00\u542f\u7f13\u5b58 . connectionPool ( pool ()) //\u8fde\u63a5\u6c60 . connectTimeout ( 10L , TimeUnit . SECONDS ) . readTimeout ( 10L , TimeUnit . SECONDS ) . build (); } } 3. \u5de5\u5177\u7c7b \u00b6 3.1 SpringUtil \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 package com.example.demo.util ; import org.slf4j.Logger ; import org.slf4j.LoggerFactory ; import org.springframework.beans.BeansException ; import org.springframework.context.ApplicationContext ; import org.springframework.context.ApplicationContextAware ; public class SpringUtil implements ApplicationContextAware { private static ApplicationContext applicationContext ; private static final Logger logger = LoggerFactory . getLogger ( SpringUtil . class ); @Override public void setApplicationContext ( ApplicationContext applicationContext ) throws BeansException { if ( SpringUtil . applicationContext == null ) { SpringUtil . applicationContext = applicationContext ; } logger . info ( \"========ApplicationContext\u914d\u7f6e\u6210\u529f,\u5728\u666e\u901a\u7c7b\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528SpringUtils.getAppContext()\u83b7\u53d6applicationContext\u5bf9\u8c61,applicationContext=\" + SpringUtil . applicationContext + \"========\" ); logger . info ( \"---------------------------------------------------------------------\" ); } //\u83b7\u53d6applicationContext public static ApplicationContext getApplicationContext () { return applicationContext ; } //\u901a\u8fc7name\u83b7\u53d6 Bean. public static Object getBean ( String name ){ return getApplicationContext (). getBean ( name ); } //\u901a\u8fc7class\u83b7\u53d6Bean. public static < T > T getBean ( Class < T > clazz ){ return getApplicationContext (). getBean ( clazz ); } //\u901a\u8fc7name,\u4ee5\u53caClazz\u8fd4\u56de\u6307\u5b9a\u7684Bean public static < T > T getBean ( String name , Class < T > clazz ){ return getApplicationContext (). getBean ( name , clazz ); } } 3.2 OkHttpUtil \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 package com.example.demo.util ; import java.util.Iterator ; import java.util.Map ; import java.util.Map.Entry ; import okhttp3.FormBody ; import okhttp3.MediaType ; import okhttp3.OkHttpClient ; import okhttp3.Request ; import okhttp3.RequestBody ; import okhttp3.Response ; import org.apache.commons.lang3.exception.ExceptionUtils ; import org.slf4j.Logger ; import org.slf4j.LoggerFactory ; public class OkHttpUtil { private static final Logger logger = LoggerFactory . getLogger ( OkHttpUtil . class ); /** * \u6839\u636emap\u83b7\u53d6get\u8bf7\u6c42\u53c2\u6570 * @param queries * @return */ public static StringBuffer getQueryString ( String url , Map < String , String > queries ){ StringBuffer sb = new StringBuffer ( url ); if ( queries != null && queries . keySet (). size () > 0 ) { boolean firstFlag = true ; Iterator < Entry < String , String >> iterator = queries . entrySet (). iterator (); while ( iterator . hasNext ()) { Entry < String , String > entry = ( Map . Entry < String , String >) iterator . next (); if ( firstFlag ) { sb . append ( \"?\" + entry . getKey () + \"=\" + entry . getValue ()); firstFlag = false ; } else { sb . append ( \"&\" + entry . getKey () + \"=\" + entry . getValue ()); } } } return sb ; } /** * \u8c03\u7528okhttp\u7684newCall\u65b9\u6cd5 * @param request * @return */ private static String execNewCall ( Request request ){ Response response = null ; try { OkHttpClient okHttpClient = SpringUtil . getBean ( OkHttpClient . class ); response = okHttpClient . newCall ( request ). execute (); //int code = response.code(); if ( response . isSuccessful ()) { return response . body (). string (); } } catch ( Exception e ) { logger . error ( \"okhttp3 put error >> ex = {}\" , ExceptionUtils . getStackTrace ( e )); } finally { if ( response != null ) { response . close (); } } return \"\" ; } /** * get * @param url \u8bf7\u6c42\u7684url * @param queries \u8bf7\u6c42\u7684\u53c2\u6570\uff0c\u5728\u6d4f\u89c8\u5668\uff1f\u540e\u9762\u7684\u6570\u636e\uff0c\u6ca1\u6709\u53ef\u4ee5\u4f20null * @return */ public static String get ( String url , Map < String , String > queries ) { StringBuffer sb = getQueryString ( url , queries ); Request request = new Request . Builder () . url ( sb . toString ()) . build (); return execNewCall ( request ); } /** * post * * @param url \u8bf7\u6c42\u7684url * @param params post form \u63d0\u4ea4\u7684\u53c2\u6570 * @return */ public static String postFormParams ( String url , Map < String , String > params ) { FormBody . Builder builder = new FormBody . Builder (); //\u6dfb\u52a0\u53c2\u6570 if ( params != null && params . keySet (). size () > 0 ) { for ( String key : params . keySet ()) { builder . add ( key , params . get ( key )); } } Request request = new Request . Builder () . url ( url ) . post ( builder . build ()) . build (); return execNewCall ( request ); } /** * Post\u8bf7\u6c42\u53d1\u9001JSON\u6570\u636e....{\"name\":\"zhangsan\",\"pwd\":\"123456\"} * \u53c2\u6570\u4e00\uff1a\u8bf7\u6c42Url * \u53c2\u6570\u4e8c\uff1a\u8bf7\u6c42\u7684JSON * \u53c2\u6570\u4e09\uff1a\u8bf7\u6c42\u56de\u8c03 */ public static String postJsonParams ( String url , String jsonParams ) { RequestBody requestBody = RequestBody . create ( MediaType . parse ( \"application/json; charset=utf-8\" ), jsonParams ); Request request = new Request . Builder () . url ( url ) . post ( requestBody ) . build (); return execNewCall ( request ); } /** * Post\u8bf7\u6c42\u53d1\u9001xml\u6570\u636e.... * \u53c2\u6570\u4e00\uff1a\u8bf7\u6c42Url * \u53c2\u6570\u4e8c\uff1a\u8bf7\u6c42\u7684xmlString * \u53c2\u6570\u4e09\uff1a\u8bf7\u6c42\u56de\u8c03 */ public static String postXmlParams ( String url , String xml ) { RequestBody requestBody = RequestBody . create ( MediaType . parse ( \"application/xml; charset=utf-8\" ), xml ); Request request = new Request . Builder () . url ( url ) . post ( requestBody ) . build (); return execNewCall ( request ); } } 4. \u4f7f\u7528\u65b9\u5f0f \u00b6 Note OkHttpUtil\u5185\u90fd\u662f\u9759\u6001\u65b9\u6cd5\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 StringUtil\u9700\u8981\u5b9e\u4f8b\u5316\uff0c\u5b9e\u4f8b\u5316\u4e24\u79cd\u7ed3\u6784\u4e09\u79cd\u65b9\u5f0f\uff1a StringUtil\u5728\u7c7b\u626b\u63cf\u8def\u5f84\u4e0b\uff0c\u76f4\u63a5\u5728StringUtil\u4e0a\u52a0\u6ce8\u89e3 @Component \u6216\u8005 @Configuration StringUtil\u4e0d\u5728\u7c7b\u626b\u63cf\u8def\u5f84\u4e0b\uff1a\u6709\u5982\u4e0b\u4e24\u79cd\u65b9\u5f0f 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import org.springframework.boot.SpringApplication ; import org.springframework.boot.autoconfigure.SpringBootApplication ; import org.springframework.context.annotation.Import ; import com.example.demo.util.SpringUtil ; @SpringBootApplication @Import ( SpringUtil . class ) //\u65b9\u5f0f\u4e00 public class DemoApplication { //\u65b9\u5f0f\u4e8c /*@Bean public SpringUtil getSpringUtil() { return new SpringUtil(); }*/ public static void main ( String [] args ) { SpringApplication . run ( DemoApplication . class , args ); } }","title":"okhttp"},{"location":"okhttp/#springboot-okhttp3","text":"Tip okhttp3 + kotlin = okhttp4","title":"springboot \u6574\u5408 okhttp3"},{"location":"okhttp/#1-pom","text":"1 2 3 4 5 6 7 8 9 <dependency> <groupId> com.squareup.okhttp3 </groupId> <artifactId> okhttp </artifactId> <version> 3.14.2 </version> </dependency> <dependency> <groupId> org.apache.commons </groupId> <artifactId> commons-lang3 </artifactId> </dependency>","title":"1. \u6dfb\u52a0pom\u4f9d\u8d56"},{"location":"okhttp/#2","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 package com.example.demo.config ; import java.security.KeyManagementException ; import java.security.NoSuchAlgorithmException ; import java.security.SecureRandom ; import java.security.cert.CertificateException ; import java.security.cert.X509Certificate ; import java.util.concurrent.TimeUnit ; import javax.net.ssl.SSLContext ; import javax.net.ssl.SSLSocketFactory ; import javax.net.ssl.TrustManager ; import javax.net.ssl.X509TrustManager ; import okhttp3.ConnectionPool ; import okhttp3.OkHttpClient ; import org.springframework.context.annotation.Bean ; import org.springframework.context.annotation.Configuration ; @Configuration public class OkHttpConfig { @Bean public X509TrustManager x509TrustManager () { return new X509TrustManager () { @Override public void checkClientTrusted ( X509Certificate [] arg0 , String arg1 ) throws CertificateException { // TODO Auto-generated method stub } @Override public void checkServerTrusted ( X509Certificate [] arg0 , String arg1 ) throws CertificateException { // TODO Auto-generated method stub } @Override public X509Certificate [] getAcceptedIssuers () { return new X509Certificate [ 0 ]; } }; } @Bean public SSLSocketFactory sslSocketFactory () { try { //\u4fe1\u4efb\u4efb\u4f55\u94fe\u63a5 SSLContext sslContext = SSLContext . getInstance ( \"TLS\" ); sslContext . init ( null , new TrustManager []{ x509TrustManager ()}, new SecureRandom ()); return sslContext . getSocketFactory (); } catch ( NoSuchAlgorithmException e ) { e . printStackTrace (); } catch ( KeyManagementException e ) { e . printStackTrace (); } return null ; } /** * Create a new connection pool with tuning parameters appropriate for a single-user application. * The tuning parameters in this pool are subject to change in future OkHttp releases. Currently */ @Bean public ConnectionPool pool () { return new ConnectionPool ( 200 , 5 , TimeUnit . MINUTES ); } @Bean public OkHttpClient okHttpClient () { return new OkHttpClient . Builder () . sslSocketFactory ( sslSocketFactory (), x509TrustManager ()) . retryOnConnectionFailure ( false ) //\u662f\u5426\u5f00\u542f\u7f13\u5b58 . connectionPool ( pool ()) //\u8fde\u63a5\u6c60 . connectTimeout ( 10L , TimeUnit . SECONDS ) . readTimeout ( 10L , TimeUnit . SECONDS ) . build (); } }","title":"2. \u914d\u7f6e\u7c7b"},{"location":"okhttp/#3","text":"","title":"3. \u5de5\u5177\u7c7b"},{"location":"okhttp/#31-springutil","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 package com.example.demo.util ; import org.slf4j.Logger ; import org.slf4j.LoggerFactory ; import org.springframework.beans.BeansException ; import org.springframework.context.ApplicationContext ; import org.springframework.context.ApplicationContextAware ; public class SpringUtil implements ApplicationContextAware { private static ApplicationContext applicationContext ; private static final Logger logger = LoggerFactory . getLogger ( SpringUtil . class ); @Override public void setApplicationContext ( ApplicationContext applicationContext ) throws BeansException { if ( SpringUtil . applicationContext == null ) { SpringUtil . applicationContext = applicationContext ; } logger . info ( \"========ApplicationContext\u914d\u7f6e\u6210\u529f,\u5728\u666e\u901a\u7c7b\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528SpringUtils.getAppContext()\u83b7\u53d6applicationContext\u5bf9\u8c61,applicationContext=\" + SpringUtil . applicationContext + \"========\" ); logger . info ( \"---------------------------------------------------------------------\" ); } //\u83b7\u53d6applicationContext public static ApplicationContext getApplicationContext () { return applicationContext ; } //\u901a\u8fc7name\u83b7\u53d6 Bean. public static Object getBean ( String name ){ return getApplicationContext (). getBean ( name ); } //\u901a\u8fc7class\u83b7\u53d6Bean. public static < T > T getBean ( Class < T > clazz ){ return getApplicationContext (). getBean ( clazz ); } //\u901a\u8fc7name,\u4ee5\u53caClazz\u8fd4\u56de\u6307\u5b9a\u7684Bean public static < T > T getBean ( String name , Class < T > clazz ){ return getApplicationContext (). getBean ( name , clazz ); } }","title":"3.1 SpringUtil"},{"location":"okhttp/#32-okhttputil","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 package com.example.demo.util ; import java.util.Iterator ; import java.util.Map ; import java.util.Map.Entry ; import okhttp3.FormBody ; import okhttp3.MediaType ; import okhttp3.OkHttpClient ; import okhttp3.Request ; import okhttp3.RequestBody ; import okhttp3.Response ; import org.apache.commons.lang3.exception.ExceptionUtils ; import org.slf4j.Logger ; import org.slf4j.LoggerFactory ; public class OkHttpUtil { private static final Logger logger = LoggerFactory . getLogger ( OkHttpUtil . class ); /** * \u6839\u636emap\u83b7\u53d6get\u8bf7\u6c42\u53c2\u6570 * @param queries * @return */ public static StringBuffer getQueryString ( String url , Map < String , String > queries ){ StringBuffer sb = new StringBuffer ( url ); if ( queries != null && queries . keySet (). size () > 0 ) { boolean firstFlag = true ; Iterator < Entry < String , String >> iterator = queries . entrySet (). iterator (); while ( iterator . hasNext ()) { Entry < String , String > entry = ( Map . Entry < String , String >) iterator . next (); if ( firstFlag ) { sb . append ( \"?\" + entry . getKey () + \"=\" + entry . getValue ()); firstFlag = false ; } else { sb . append ( \"&\" + entry . getKey () + \"=\" + entry . getValue ()); } } } return sb ; } /** * \u8c03\u7528okhttp\u7684newCall\u65b9\u6cd5 * @param request * @return */ private static String execNewCall ( Request request ){ Response response = null ; try { OkHttpClient okHttpClient = SpringUtil . getBean ( OkHttpClient . class ); response = okHttpClient . newCall ( request ). execute (); //int code = response.code(); if ( response . isSuccessful ()) { return response . body (). string (); } } catch ( Exception e ) { logger . error ( \"okhttp3 put error >> ex = {}\" , ExceptionUtils . getStackTrace ( e )); } finally { if ( response != null ) { response . close (); } } return \"\" ; } /** * get * @param url \u8bf7\u6c42\u7684url * @param queries \u8bf7\u6c42\u7684\u53c2\u6570\uff0c\u5728\u6d4f\u89c8\u5668\uff1f\u540e\u9762\u7684\u6570\u636e\uff0c\u6ca1\u6709\u53ef\u4ee5\u4f20null * @return */ public static String get ( String url , Map < String , String > queries ) { StringBuffer sb = getQueryString ( url , queries ); Request request = new Request . Builder () . url ( sb . toString ()) . build (); return execNewCall ( request ); } /** * post * * @param url \u8bf7\u6c42\u7684url * @param params post form \u63d0\u4ea4\u7684\u53c2\u6570 * @return */ public static String postFormParams ( String url , Map < String , String > params ) { FormBody . Builder builder = new FormBody . Builder (); //\u6dfb\u52a0\u53c2\u6570 if ( params != null && params . keySet (). size () > 0 ) { for ( String key : params . keySet ()) { builder . add ( key , params . get ( key )); } } Request request = new Request . Builder () . url ( url ) . post ( builder . build ()) . build (); return execNewCall ( request ); } /** * Post\u8bf7\u6c42\u53d1\u9001JSON\u6570\u636e....{\"name\":\"zhangsan\",\"pwd\":\"123456\"} * \u53c2\u6570\u4e00\uff1a\u8bf7\u6c42Url * \u53c2\u6570\u4e8c\uff1a\u8bf7\u6c42\u7684JSON * \u53c2\u6570\u4e09\uff1a\u8bf7\u6c42\u56de\u8c03 */ public static String postJsonParams ( String url , String jsonParams ) { RequestBody requestBody = RequestBody . create ( MediaType . parse ( \"application/json; charset=utf-8\" ), jsonParams ); Request request = new Request . Builder () . url ( url ) . post ( requestBody ) . build (); return execNewCall ( request ); } /** * Post\u8bf7\u6c42\u53d1\u9001xml\u6570\u636e.... * \u53c2\u6570\u4e00\uff1a\u8bf7\u6c42Url * \u53c2\u6570\u4e8c\uff1a\u8bf7\u6c42\u7684xmlString * \u53c2\u6570\u4e09\uff1a\u8bf7\u6c42\u56de\u8c03 */ public static String postXmlParams ( String url , String xml ) { RequestBody requestBody = RequestBody . create ( MediaType . parse ( \"application/xml; charset=utf-8\" ), xml ); Request request = new Request . Builder () . url ( url ) . post ( requestBody ) . build (); return execNewCall ( request ); } }","title":"3.2 OkHttpUtil"},{"location":"okhttp/#4","text":"Note OkHttpUtil\u5185\u90fd\u662f\u9759\u6001\u65b9\u6cd5\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 StringUtil\u9700\u8981\u5b9e\u4f8b\u5316\uff0c\u5b9e\u4f8b\u5316\u4e24\u79cd\u7ed3\u6784\u4e09\u79cd\u65b9\u5f0f\uff1a StringUtil\u5728\u7c7b\u626b\u63cf\u8def\u5f84\u4e0b\uff0c\u76f4\u63a5\u5728StringUtil\u4e0a\u52a0\u6ce8\u89e3 @Component \u6216\u8005 @Configuration StringUtil\u4e0d\u5728\u7c7b\u626b\u63cf\u8def\u5f84\u4e0b\uff1a\u6709\u5982\u4e0b\u4e24\u79cd\u65b9\u5f0f 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import org.springframework.boot.SpringApplication ; import org.springframework.boot.autoconfigure.SpringBootApplication ; import org.springframework.context.annotation.Import ; import com.example.demo.util.SpringUtil ; @SpringBootApplication @Import ( SpringUtil . class ) //\u65b9\u5f0f\u4e00 public class DemoApplication { //\u65b9\u5f0f\u4e8c /*@Bean public SpringUtil getSpringUtil() { return new SpringUtil(); }*/ public static void main ( String [] args ) { SpringApplication . run ( DemoApplication . class , args ); } }","title":"4. \u4f7f\u7528\u65b9\u5f0f"}]}